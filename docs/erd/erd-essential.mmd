erDiagram
    %% ============================================
    %% ERIKA - ERD (pouze klíče - grafová struktura)
    %% ============================================

    %% === CORE ===
    Mandant ||--o{ Projekt : "vlastni"
    Kunde ||--o{ Projekt : "objednava"
    Projekt ||--o{ Leistung : "obsahuje"
    Projekt ||--o{ BudgetVerfolgung : "sleduje"
    Projekt ||--o{ Case : "pouziva"
    Projekt ||--o{ Transport : "planuje"
    Projekt ||--o{ Fremdfertigung : "zadava"
    Projekt }o--o{ Mitarbeiter : "team"
    Mitarbeiter ||--o{ Projekt : "projekt_manager"

    Mandant {
        string name PK
    }

    Kunde {
        string name PK
    }

    Projekt {
        string projekt_nr PK
        string pa_nummer UK
        link kunde FK
        link mandant FK
        link projekt_manager FK
    }

    %% === LEISTUNG ===
    Leistung ||--o{ LeistungAngebot : "versionen"

    Leistung {
        string leistung_nr PK
        link projekt FK
    }

    LeistungAngebot {
        string angebot_nr PK
        link leistung FK
    }

    %% === MASTERLISTE (stromová hierarchie) ===
    Leistung ||--o{ Baugruppe : "rozdelena"
    Baugruppe }o--o| Baugruppe : "parent"
    Baugruppe ||--o{ MasterlistenElement : "obsahuje"
    MasterlistenElement }o--o| Fremdfertigung : "zadano"

    Baugruppe {
        string bg_nr PK
        link leistung FK
        link parent FK
    }

    MasterlistenElement {
        int zeile PK
        link baugruppe FK
        link fremdfertigung FK
    }

    %% === LOGISTICS ===
    Case ||--o{ Colli : "enthaelt"
    Colli }o--|| ColliArt : "typ"
    Transport ||--o{ TransportColli : "laedt"
    TransportColli }o--|| Colli : "colli"
    Transport }o--|| Spedition : "durchgefuehrt"

    Case {
        string case_nr PK
        link projekt FK
    }

    Colli {
        string colli_nr PK
        link case FK
        link colli_art FK
    }

    ColliArt {
        string name PK
    }

    Transport {
        string transport_nr PK
        link projekt FK
        link spedition FK
    }

    TransportColli {
        string name PK
        link transport FK
        link colli FK
    }

    Spedition {
        string name PK
    }

    %% === BUDGET ===
    BudgetVerfolgung }o--|| BudgetPosition : "kategorie"

    BudgetPosition {
        int position_nr PK
    }

    BudgetVerfolgung {
        string name PK
        link projekt FK
        link position FK
    }

    %% === FREMDFERTIGUNG ===
    Fremdfertigung }o--|| Firma : "auftragnehmer"
    Fremdfertigung }o--o| Leistung : "fuer"

    Firma {
        string name PK
    }

    Fremdfertigung {
        string ff_nr PK
        link projekt FK
        link firma FK
        link leistung FK
    }

    %% === HR ===
    Mitarbeiter ||--o{ Abwesenheit : "plant"
    Mitarbeiter ||--o{ MitarbeiterProjekt : "arbeitet"
    MitarbeiterProjekt }o--|| Projekt : "an"

    Mitarbeiter {
        string name PK
    }

    MitarbeiterProjekt {
        string name PK
        link mitarbeiter FK
        link projekt FK
    }

    Abwesenheit {
        string name PK
        link mitarbeiter FK
    }

